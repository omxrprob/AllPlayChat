<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AllPlay HQ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>ðŸŽ® AllPlay Team Hub</h1>
        <div id="user-info">
            <span><strong>Your ID:</strong> <code id="user-id"></code></span>
            <button onclick="copyID()">ðŸ“‹ Copy</button>
        </div>
        <nav>
            <button onclick="showTab('chat')">Chat</button>
            <button onclick="showTab('announcements')">Announcements</button>
        </nav>
    </header>

    <main>
        <section id="chat" class="tab active">
            <h2>ðŸ’¬ Team Chat</h2>
            <div id="chat-box"></div>
            <form onsubmit="sendMessage(event)">
                <input type="text" id="username" placeholder="Name (Optional)">
                <input type="text" id="message" placeholder="Type a message..." required>
                <button type="submit">Send</button>
            </form>
        </section>

        <section id="announcements" class="tab">
            <h2>ðŸ“¢ Announcements</h2>
            <ul id="announcement-list"></ul>
            <form onsubmit="postAnnouncement(event)">
                <input type="text" id="announcement" placeholder="Write announcement..." required>
                <button type="submit">Post</button>
            </form>
        </section>
    </main>

    <script>
        // Generate or retrieve persistent ID
        let userID = localStorage.getItem("allplay_user_id");
        if (!userID) {
            userID = "user-" + Math.random().toString(36).substring(2, 10);
            localStorage.setItem("allplay_user_id", userID);
        }
        document.getElementById("user-id").textContent = userID;

        // Copy user ID
        function copyID() {
            navigator.clipboard.writeText(userID);
            alert("User ID copied!");
        }

        // Tab switcher
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
        }

        // Load messages from localStorage
        function loadChat() {
            const chat = JSON.parse(localStorage.getItem("chat")) || [];
            const chatBox = document.getElementById("chat-box");
            chatBox.innerHTML = chat.map(m => `<p><strong>${m.user}</strong>: ${m.msg}</p>`).join('');
        }

        function loadAnnouncements() {
            const announcements = JSON.parse(localStorage.getItem("announcements")) || [];
            const list = document.getElementById("announcement-list");
            list.innerHTML = announcements.map(a => `<li>ðŸ“¢ ${a}</li>`).join('');
        }

        // Send a message
        function sendMessage(event) {
            event.preventDefault();
            const nameInput = document.getElementById("username");
            const msgInput = document.getElementById("message");
            const name = nameInput.value.trim() || userID;
            const msg = msgInput.value.trim();
            if (!msg) return;

            const chat = JSON.parse(localStorage.getItem("chat")) || [];
            chat.push({ user: name, msg });
            localStorage.setItem("chat", JSON.stringify(chat));

            msgInput.value = "";
            loadChat();
        }

        // Post announcement
        function postAnnouncement(event) {
            event.preventDefault();
            const annInput = document.getElementById("announcement");
            const ann = annInput.value.trim();
            if (!ann) return;

            const announcements = JSON.parse(localStorage.getItem("announcements")) || [];
            announcements.push(ann);
            localStorage.setItem("announcements", JSON.stringify(announcements));

            annInput.value = "";
            loadAnnouncements();
        }

        // Load on start
        loadChat();
        loadAnnouncements();
    </script>
</body>
</html>
